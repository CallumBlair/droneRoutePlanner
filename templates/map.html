{% extends "components/base.html" %} 
{% set active_page = "map" %} 

{% block content %} 
<div id="content"> </div>
        <div class="w3-sidebar w3-bar-block w3-animate-left w3-card w3-grey" style="width:25%" id="mySidebar">
          <button class="w3-bar-item w3-button w3-large"
          onclick="w3_close()">Close &times;</button>
          <div id="setStart">
            <p>Start Node:</p>
            <span id="startNode"></span>
            <button href="#" class="w3-bar-item w3-button" style="width:100%;" onclick="setStart()" id="startButton">Set start node</button>
          </div>

          <div id="setStop1" style="display:none;">
            <p>Stop 1 Node:</p>
            <span id="stop1Node"></span>
            <button href="#" class="w3-bar-item w3-button" style="width:100%;" onclick="setStop1()" id="stop1Button">Set target node</button>
          </div>

          <div id="setStop2" style="display:none;">
            <p>Stop 2 Node:</p>
            <span id="stop2Node"></span>
            <button href="#" class="w3-bar-item w3-button" style="width:100%;" onclick="setStop2()" id="stop2Button">Set target node</button>
          </div>

          <div id="setStop3" style="display:none;">
            <p>Stop 3 Node:</p>
            <span id="stop3Node"></span>
            <button href="#" class="w3-bar-item w3-button" style="width:100%;" onclick="setStop3()" id="stop3Button">Set target node</button>
          </div>

          <div id="setStop4" style="display:none;">
            <p>Stop 4 Node:</p>
            <span id="stop4Node"></span>
            <button href="#" class="w3-bar-item w3-button" style="width:100%;" onclick="setStop4()" id="stop4Button">Set target node</button>
          </div>

          <div id="setTarget">
            <p>Target Node:</p>
            <span id="targetNode"></span>
            <button href="#" class="w3-bar-item w3-button" style="width:100%;" onclick="setTarget()" id="targetButton">Set target node</button>
          </div>


          <div id="addStop">
            <button href="#" class="w3-bar-item w3-button" style="width:100%;" onclick="addStop()" id="addStop">Add stop to route</button>
          </div>

          <div id="removeStop">
            <button href="#" class="w3-bar-item w3-button" style="width:100%;" onclick="removeStop()" id="removeStop">Remove stop from route</button>
          </div>



          <!--<a href="#" class="w3-bar-item w3-button">Link 3</a> -->
          <div id="requestRoute">
            <button href="#" class="w3-bar-item w3-button" style="width:100%;" onclick="fireRequest()" id="fireButton">Request Route</button>
          </div>

          <div id="removeLine" style="display:none;">
            <button href="#" class="w3-bar-item w3-button" style="width:100%;" onclick="removeLine()" id="removeLine">Remove currently displayed line</button>
          </div>

          <div id="requestForm" style="visibility:hidden;"> 
            <form id="myForm" action="/requestPath" method="post"> 
                <input type="hidden" id="stNode" name="stNode" value="">
                <input type="hidden" id="1Node" name="1Node" value="">
                <input type="hidden" id="2Node" name="2Node" value="">
                <input type="hidden" id="3Node" name="3Node" value="">
                <input type="hidden" id="4Node" name="4Node" value="">
                <input type="hidden" id="tgtNode" name="tgtNode" value="">
                <input type="submit" name="action" value="Submit" id="fireButton">
            </form>
          </div>

        </div>
   
        <div class="w3-grey" style="width:100%;">
          <button class="w3-button w3-grey w3-xlarge" onclick="w3_open()">&#9776;</button>
          <form id="myForm" action="/mapAuth" method="post" style="float:right;margin:10px 0 0 0;">
            <input type="text" name="userName" id="userName" value="{{username}}" >
            <input type="submit" name="submitLogin" value="Login" id="submitLogin">
        </form>
          
        </div>
              


        <div class="map-wrapper" id="maper">
            <div id="map">
            </div>
        </div>

        <script type= "text/javascript">
        var currentLocation = [];
        var startingNode = [];
        var targetedNode = [];
        //var path = JSON.parse({{ path| tojson}});
        var path = {{path}};
        //path = []
        console.log(path)
        var startMarker;
        var targetMarker; 
        var marker1;
        var marker2;
        var marker3;
        var marker4;
        
        var previewLine;
        var previewLine1;
        var previewLine2;
        var previewLine3;
        var previewLine4;
        var stopCounter = 0;
        var node1 = [0,0];
        var node2 = [0,0];
        var node3 = [0,0];
        var node4 = [0,0];

        var defaultIcon = L.icon({
            iconUrl: 'static/css/images/marker-icon.png',
            shadowUrl: 'static/css/images/marker-shadow.png',

            iconSize:     [23, 40], // size of the icon
            shadowSize:   [35, 40], // size of the shadow
            iconAnchor:   [14, 37], // point of the icon which will correspond to marker's location
            shadowAnchor: [7, 41],  // the same for the shadow
            popupAnchor:  [-1, -38] // point from which the popup should open relative to the iconAnchor
        });


        var startIcon = L.icon({
            iconUrl: 'static/css/images/marker-icon-start.png',
            shadowUrl: 'static/css/images/marker-shadow.png',

            iconSize:     [23, 40], // size of the icon
            shadowSize:   [35, 40], // size of the shadow
            iconAnchor:   [14, 37], // point of the icon which will correspond to marker's location
            shadowAnchor: [7, 41],  // the same for the shadow
            popupAnchor:  [-1, -38] // point from which the popup should open relative to the iconAnchor
        });

        var oneIcon = L.icon({
            iconUrl: 'static/css/images/marker-icon-one.png',
            shadowUrl: 'static/css/images/marker-shadow.png',

            iconSize:     [23, 40], // size of the icon
            shadowSize:   [35, 40], // size of the shadow
            iconAnchor:   [14, 37], // point of the icon which will correspond to marker's location
            shadowAnchor: [7, 41],  // the same for the shadow
            popupAnchor:  [-1, -38] // point from which the popup should open relative to the iconAnchor
        });

        var twoIcon = L.icon({
            iconUrl: 'static/css/images/marker-icon-two.png',
            shadowUrl: 'static/css/images/marker-shadow.png',

            iconSize:     [23, 40], // size of the icon
            shadowSize:   [35, 40], // size of the shadow
            iconAnchor:   [14, 37], // point of the icon which will correspond to marker's location
            shadowAnchor: [7, 41],  // the same for the shadow
            popupAnchor:  [-1, -38] // point from which the popup should open relative to the iconAnchor
        });

        var threeIcon = L.icon({
            iconUrl: 'static/css/images/marker-icon-three.png',
            shadowUrl: 'static/css/images/marker-shadow.png',

            iconSize:     [23, 40], // size of the icon
            shadowSize:   [35, 40], // size of the shadow
            iconAnchor:   [14, 37], // point of the icon which will correspond to marker's location
            shadowAnchor: [7, 41],  // the same for the shadow
            popupAnchor:  [-1, -38] // point from which the popup should open relative to the iconAnchor
        });

        var fourIcon = L.icon({
            iconUrl: 'static/css/images/marker-icon-four.png',
            shadowUrl: 'static/css/images/marker-shadow.png',

            iconSize:     [23, 40], // size of the icon
            shadowSize:   [35, 40], // size of the shadow
            iconAnchor:   [14, 37], // point of the icon which will correspond to marker's location
            shadowAnchor: [7, 41],  // the same for the shadow
            popupAnchor:  [-1, -38] // point from which the popup should open relative to the iconAnchor
        });




        document.getElementById("startNode").innerHTML = "Unselected"
        document.getElementById("targetNode").innerHTML = "Unselected"
        document.getElementById("stop1Node").innerHTML = "Unselected"
        document.getElementById("stop2Node").innerHTML = "Unselected"
        document.getElementById("stop3Node").innerHTML = "Unselected"
        document.getElementById("stop4Node").innerHTML = "Unselected"

        function removeLine(){
            line.remove(map)
            document.getElementById("removeLine").style.display = "none";
        }


        function fireRequest(){
            if(document.getElementById("startNode").innerHTML == "Unselected" || document.getElementById("targetNode").innerHTML == "Unselected"){
                alert("Ensure both start and target nodes are selected")
            }else{
                document.getElementById("stNode").value = (startingNode);
                document.getElementById("tgtNode").value = (targetedNode);
                document.getElementById("1Node").value = (node1);
                document.getElementById("2Node").value = (node2);
                document.getElementById("3Node").value = (node3);
                document.getElementById("4Node").value = (node4);

                document.getElementById("myForm").submit(); 
            }
        }


        function setStart() {
            if(previewLine){
                previewLine.remove(map)
                
            }
            if(currentLocation.length == 0){
                document.getElementById("startNode").innerHTML = "Unselected";
                document.getElementById("startButton").innerHTML = "Please select start again";
                map.removeLayer(startMarker);

            }else{
                document.getElementById("startNode").innerHTML = currentLocation;
                document.getElementById("startButton").innerHTML = "Set start node";
                startingNode = currentLocation
                if(startMarker){
                    map.removeLayer(startMarker);
                }
                
                startMarker = new L.marker(currentLocation, {icon: startIcon}).addTo(map);
                map.removeLayer(marker);
                if(startMarker && marker1){
                    previewLine = new L.Polyline([startMarker.getLatLng(), marker1.getLatLng()], {
                        color: "purple",
                         weight: 3,})
                    previewLine.addTo(map)
                }else if(startMarker && targetMarker){
                    previewLine = new L.Polyline([startMarker.getLatLng(), targetMarker.getLatLng()], {
                        color: "purple",
                         weight: 3,})
                    previewLine.addTo(map)
                }

            }
            currentLocation = []
        }

        
        function setTarget() {
            if((stopCounter == 0 && startMarker)||(stopCounter == 1 && marker1)||(stopCounter == 2 && marker2)||(stopCounter == 3 && marker3)||(stopCounter == 4 && marker4)){
                if(currentLocation.length == 0){
                    document.getElementById("targetNode").innerHTML = "Unselected";
                    document.getElementById("targetButton").innerHTML = "Please select target again";
                    map.removeLayer(targetMarker);
                }else{
                    document.getElementById("targetNode").innerHTML = currentLocation;
                    document.getElementById("targetButton").innerHTML = "Set target node";
                    if(targetMarker){
                        map.removeLayer(targetMarker);
                    }
                    targetMarker = new L.marker(currentLocation, {icon: defaultIcon}).addTo(map);
                    map.removeLayer(marker);
                    if(marker4 && targetMarker){
                        if(previewLine4){
                            previewLine4.remove(map)    
                        }
                        previewLine4 = new L.Polyline([marker4.getLatLng(), targetMarker.getLatLng()], {
                            color: "purple",
                            weight: 3,})
                        previewLine4.addTo(map)
                    }else if(marker3 && targetMarker){
                        if(previewLine3){
                            previewLine3.remove(map)    
                        }
                        previewLine3 = new L.Polyline([marker3.getLatLng(), targetMarker.getLatLng()], {
                            color: "purple",
                            weight: 3,})
                        previewLine3.addTo(map)
                    }else if(marker2 && targetMarker){
                        if(previewLine2){
                            previewLine2.remove(map)    
                        }
                        previewLine2 = new L.Polyline([marker2.getLatLng(), targetMarker.getLatLng()], {
                            color: "purple",
                            weight: 3,})
                        previewLine2.addTo(map)
                    }else if(marker1 && targetMarker){
                        if(previewLine1){
                            previewLine1.remove(map)    
                        }
                        previewLine1 = new L.Polyline([marker1.getLatLng(), targetMarker.getLatLng()], {
                            color: "purple",
                            weight: 3,})
                        previewLine1.addTo(map)
                    }else if(startMarker && targetMarker){
                        if(previewLine){
                            previewLine.remove(map)    
                        }
                        previewLine = new L.Polyline([startMarker.getLatLng(), targetMarker.getLatLng()], {
                            color: "purple",
                            weight: 3,})
                        previewLine.addTo(map)
                    }
                }



                    targetedNode = currentLocation
                
                currentLocation = []
            }else{
                alert("Please ensure you have placed the previous node")
            }
        }

        
        function setStop1() {
            if(startMarker){
                if(previewLine1){
                    previewLine1.remove(map)
                    
                }
                if(previewLine){
                    previewLine.remove(map)
                }
                if(currentLocation.length == 0){
                    document.getElementById("stop1Node").innerHTML = "Unselected";
                    document.getElementById("stop1Button").innerHTML = "Please select target again";
                    map.removeLayer(targetMarker);
                }else{
                    document.getElementById("stop1Node").innerHTML = currentLocation;
                    document.getElementById("stop1Button").innerHTML = "Set target node";
                    if(marker1){
                        map.removeLayer(marker1);
                    }
                    marker1 = new L.marker(currentLocation, {icon: oneIcon}).addTo(map);
                    map.removeLayer(marker);
                    if(marker1 && marker2){
                        previewLine1 = new L.Polyline([marker1.getLatLng(), marker2.getLatLng()], {
                            color: "purple",
                            weight: 3,})
                        previewLine1.addTo(map)
                    }else if(marker1 && targetMarker){
                        previewLine1 = new L.Polyline([marker1.getLatLng(), targetMarker.getLatLng()], {
                            color: "purple",
                            weight: 3,})
                        previewLine1.addTo(map)
                    }

                    if(startMarker && marker1){
                        previewLine = new L.Polyline([startMarker.getLatLng(), marker1.getLatLng()], {
                            color: "purple",
                            weight: 3,})
                        previewLine.addTo(map)
                    }
                    targetedNode = currentLocation
                    
                    node1 = currentLocation
                }
                currentLocation = []
            }else{
                alert("Please place a start point")
            }
        }


        function setStop2() {
            if(marker1){
                if(previewLine2){
                    previewLine2.remove(map)
                }
                if(previewLine1){
                    previewLine1.remove(map)
                }
                if(currentLocation.length == 0){
                    document.getElementById("stop2Node").innerHTML = "Unselected";
                    document.getElementById("stop2Button").innerHTML = "Please select target again";
                    map.removeLayer(targetMarker);
                }else{
                    document.getElementById("stop2Node").innerHTML = currentLocation;
                    document.getElementById("stop2Button").innerHTML = "Set target node";
                    if(marker2){
                        map.removeLayer(marker2);
                    }
                    marker2 = new L.marker(currentLocation, {icon: twoIcon}).addTo(map);
                    map.removeLayer(marker);
                    if(marker2 && marker3){
                        previewLine2 = new L.Polyline([marker2.getLatLng(), marker3.getLatLng()], {
                            color: "purple",
                            weight: 3,})
                        previewLine2.addTo(map)
                    }else if(marker2 && targetMarker){
                        previewLine2 = new L.Polyline([marker2.getLatLng(), targetMarker.getLatLng()], {
                            color: "purple",
                            weight: 3,})
                        previewLine2.addTo(map)
                    }

                    if(marker1 && marker2){
                        previewLine1 = new L.Polyline([marker1.getLatLng(), marker2.getLatLng()], {
                            color: "purple",
                            weight: 3,})
                        previewLine1.addTo(map)
                    }

                    node2 = currentLocation
                }
                currentLocation = []
            }else{
                alert("Please place the previous node")
            }
        }


        function setStop3() {
            if(marker2){
                if(previewLine3){
                    previewLine3.remove(map)
                }
                if(previewLine2){
                    previewLine2.remove(map)
                }
                if(currentLocation.length == 0){
                    document.getElementById("stop3Node").innerHTML = "Unselected";
                    document.getElementById("stop3Button").innerHTML = "Please select target again";
                    map.removeLayer(targetMarker);
                }else{
                    document.getElementById("stop3Node").innerHTML = currentLocation;
                    document.getElementById("stop3Button").innerHTML = "Set target node";
                    if(marker3){
                        map.removeLayer(marker3);
                    }
                    marker3 = new L.marker(currentLocation, {icon: threeIcon}).addTo(map);
                    map.removeLayer(marker);
                    if(marker3 && marker4){
                        previewLine3 = new L.Polyline([marker3.getLatLng(), marker4.getLatLng()], {
                            color: "purple",
                            weight: 3,})
                        previewLine3.addTo(map)
                    }else if(marker3 && targetMarker){
                        previewLine3 = new L.Polyline([marker3.getLatLng(), targetMarker.getLatLng()], {
                            color: "purple",
                            weight: 3,})
                        previewLine3.addTo(map)
                    }

                    if(marker2 && marker3){
                        previewLine2 = new L.Polyline([marker2.getLatLng(), marker3.getLatLng()], {
                            color: "purple",
                            weight: 3,})
                        previewLine2.addTo(map)
                    }

                    node3 = currentLocation
                }
                currentLocation = []
            }else{
                alert("Please place the previous node")
            }
        }
    

        function setStop4() {
            if(marker3){
                if(previewLine4){
                    previewLine4.remove(map)  
                }
                if(previewLine3){
                    previewLine3.remove(map)
                }
                if(currentLocation.length == 0){
                    document.getElementById("stop4Node").innerHTML = "Unselected";
                    document.getElementById("stop4Button").innerHTML = "Please select target again";
                    map.removeLayer(targetMarker);
                }else{
                    document.getElementById("stop4Node").innerHTML = currentLocation;
                    document.getElementById("stop4Button").innerHTML = "Set target node";
                    if(marker4){
                        map.removeLayer(marker4);
                    }
                    marker4 = new L.marker(currentLocation, {icon: fourIcon}).addTo(map);
                    map.removeLayer(marker);
                    if(marker4 && targetMarker){
                        previewLine4 = new L.Polyline([marker4.getLatLng(), targetMarker.getLatLng()], {
                            color: "purple",
                            weight: 3,})
                        previewLine4.addTo(map)
                    }

                    if(marker3 && marker4){
                        previewLine3 = new L.Polyline([marker3.getLatLng(), marker4.getLatLng()], {
                            color: "purple",
                            weight: 3,})
                        previewLine3.addTo(map)
                    }


                    node4 = currentLocation
                }
                currentLocation = []
            }else{
                alert("Please place the previous node")
            }
        }


        




        function addStop(){
            //console.log("hi")
            if(stopCounter < 4){
                var nodes = ["setStop1","setStop2","setStop3","setStop4"];
                document.getElementById(nodes[stopCounter]).style.display = "block";
                stopCounter++;
            }else {
                alert("Max stops reached")
            }
        }

        function removeStop(){
            if(stopCounter > 0){
                stopCounter = stopCounter - 1;
            }
            var nodes = ["setStop4","setStop3","setStop2","setStop1"];
            var node2 = ["stop4Node","stop3Node","stop2Node","stop1Node"]
            
            for(let i = 0; i<nodes.length; i++) {
                if(document.getElementById(nodes[i]).style.display  == "block"){
                    document.getElementById(nodes[i]).style.display = "none";
                    document.getElementById(node2[i]).innerHTML = "Unselected";
                    if(i==0){
                        //currentLocation = targetedNode
                        try{
                            previewLine3.remove(map) 
                            previewLine4.remove(map)
                            map.removeLayer(marker4);
                        }catch(err){}
                        node4 = [0,0];
                        marker4 = undefined;
                        if(targetMarker){
                            currentLocation = targetMarker.getLatLng()
                            setTarget()
                        }
                    }else if (i==1){
                        //currentLocation = targetedNode
                        try{
                        previewLine2.remove(map) 
                        previewLine3.remove(map) 
                        map.removeLayer(marker3);
                        }catch(err){}

                        node3 = [0,0];
                        marker3 = undefined;
                        if(targetMarker){
                            currentLocation = targetMarker.getLatLng()
                            setTarget()
                        }
                    }else if(i==2){
                        //currentLocation = targetedNode
                        try{
                            previewLine1.remove(map) 
                            previewLine2.remove(map) 
                            map.removeLayer(marker2);
                        }catch(err){}
                        node2 = [0,0];
                        marker2 = undefined;
                        if(targetMarker){
                            currentLocation = targetMarker.getLatLng()
                            setTarget()
                        }
                    }else if (i==3){
                        //currentLocation = targetedNode
                        try {
                            previewLine.remove(map);
                            previewLine1.remove(map);
                            map.removeLayer(marker1);
                        }catch(err){}
                     

                        node1 = [0,0];
                        marker1 = undefined;
                        if(targetMarker){
                            currentLocation = targetMarker.getLatLng()
                            setTarget()
                        }
                    }
                    
                    break;
                }
            }
        }


        function w3_open() {
            document.getElementById("mySidebar").style.display = "block";
            document.getElementById("maper").style.width = "75%";
        }

        function w3_close() {
            document.getElementById("mySidebar").style.display = "none";
            document.getElementById("maper").style.width = "100%";
        }

        w3_close()
	    //var bound = JSON.parse('{{ boundaries | tojson}}');
        var marker;
	    var bound = JSON.parse({{ boundaries | tojson}});
        console.log(bound);
        var map = L.map('map').setView([50.71, -2.44], 13);
        

	    var popup = L.popup();
            L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
            }).addTo(map);

	    
	    for(let i = 0; i < bound.length; i++) {
    		//console.log(bound["features"][i]["properties"]["Name"])
		    //var polygondata = bound["features"][i]["geometry"]["coordinates"];
            var polygondata = bound[i]["geometry"]["coordinates"];
	
            polygondata[0].forEach(function (item, index) {
                polygondata[0][index] = L.GeoJSON.coordsToLatLng(polygondata[0][index])
            });

            var polygon = L.polygon(
            polygondata[0]
            ).addTo(map);
            if (bound[i]["properties"]["boundaryType"] == "obstacle"){
                polygon.setStyle({fillColor:"#FF0000"});
                polygon.bringToFront();
            }
            if (bound[i]["properties"]["boundaryType"] == "property"){
                map.fitBounds(polygon.getBounds());
                polygon.on("click", function (event){
                    //console.log(event.latlng.lat + ", " + event.latlng.lng);
                    currentLocation = [event.latlng.lat, event.latlng.lng]
                    if(marker) {
                        map.removeLayer(marker);
                    }
            marker = new L.marker([event.latlng.lat, event.latlng.lng], {icon: defaultIcon}).addTo(map);
        })
            }
		    //polygon.bindPopup(bound["features"][i]["properties"]["desc"]);
            polygon.on("click", function (event) {
                map.fire("click", event);
            });
		
	    };

        
        if (path.length != 1){
            console.log("run")
            var pointLine = [];
            for(let i = 0; i<path.length; i++) {
                cord = path[i];
                coord = new L.latLng(cord[1], cord[0]);
                pointLine.push(coord);
            
            };
            var line = new L.Polyline(pointLine, {
                color: "red",
                weight: 3,
            });
            line.addTo(map);
            
        };

        if(line){
            document.getElementById("removeLine").style.display = "block";
        }

        /*
	    var testLine =[[-2.3943867617217642, 50.73105944633322], [-2.3943867617217642, 50.730632552316685], [-2.394918748219613, 50.73020565830015], [-2.3954507347174623, 50.729778764283616], [-2.395982721215311, 50.72935187026708], [-2.3965147077131603, 50.72892497625054], [-2.3965147077131603, 50.728498082234005], [-2.3965147077131603, 50.72807118821747], [-2.395982721215311, 50.727644294200935], [-2.3954507347174623, 50.7272174001844], [-2.394918748219613, 50.726790506167866], [-2.3943867617217642, 50.72636361215133], [-2.3943867617217642, 50.7259367181348], [-2.3943867617217642, 50.72550982411826], [-2.394918748219613, 50.72508293010173], [-2.3954507347174623, 50.724656036085186], [-2.395982721215311, 50.72422914206865], [-2.3965147077131603, 50.72380224805212], [-2.397046694211009, 50.72337535403558], [-2.3975786807088584, 50.72294846001905], [-2.398110667206707, 50.72252156600251], [-2.398642653704556, 50.72209467198598], [-2.3991746402024052, 50.721667777969444], [-2.399706626700254, 50.72124088395291], [-2.4002386131981033, 50.72081398993637], [-2.400770599695952, 50.72038709591983], [-2.400770599695952, 50.7199602019033], [-2.4013025861938013, 50.71953330788676], [-2.40183457269165, 50.71910641387023], [-2.4023665591894994, 50.718679519853694], [-2.402898545687348, 50.71825262583716], [-2.4034305321851974, 50.717825731820625], [-2.4039625186830462, 50.71739883780409], [-2.404494505180895, 50.71739883780409], [-2.4050264916787443, 50.71739883780409], [-2.405558478176593, 50.71697194378755], [-2.4060904646744423, 50.716545049771014], [-2.406622451172291, 50.71611815575448], [-2.4071544376701404, 50.715691261737945], [-2.407686424167989, 50.71526436772141], [-2.4082184106658384, 50.714837473704875], [-2.408750397163687, 50.71441057968834], [-2.409282383661536, 50.713983685671806], [-2.4098143701593853, 50.71355679165527]];
        var pointLine = [];
        for(let i = 0; i<testLine.length; i++) {
            cord = testLine[i];
            coord = new L.latLng(cord[1], cord[0]);
            pointLine.push(coord);
            
        };
        
        var line = new L.Polyline(pointLine, {
            color: "red",
            weight: 3,
        });
        line.addTo(map);


        var testLine2 = [[-2.391584966166426, 50.713257965843695], [-2.3918154936488274, 50.713257965843695], [-2.3920460211312284, 50.713257965843695], [-2.39227654861363, 50.713257965843695], [-2.392507076096031, 50.713257965843695], [-2.3927376035784325, 50.713257965843695], [-2.3929681310608335, 50.713257965843695], [-2.3931986585432345, 50.713257965843695], [-2.393429186025636, 50.713257965843695], [-2.393659713508037, 50.713257965843695], [-2.3938902409904386, 50.713257965843695], [-2.3941207684728396, 50.713257965843695], [-2.394351295955241, 50.713257965843695], [-2.394581823437642, 50.713257965843695], [-2.394812350920043, 50.713257965843695], [-2.3950428784024447, 50.713257965843695], [-2.3952734058848457, 50.713257965843695], [-2.395503933367247, 50.71344295325086], [-2.3957344608496483, 50.71362794065802], [-2.3959649883320497, 50.71381292806519], [-2.396195515814451, 50.713997915472355], [-2.396426043296852, 50.71418290287952], [-2.3966565707792533, 50.71436789028669], [-2.3968870982616544, 50.714552877693855], [-2.397117625744056, 50.714737865101014], [-2.397348153226457, 50.71492285250818], [-2.3975786807088584, 50.71510783991535], [-2.3978092081912594, 50.715292827322514], [-2.3980397356736605, 50.71547781472968], [-2.398270263156062, 50.71566280213684], [-2.398500790638463, 50.71584778954401], [-2.3987313181208645, 50.716032776951174], [-2.3989618456032655, 50.71621776435834], [-2.399192373085667, 50.71640275176551], [-2.399422900568068, 50.71658773917267], [-2.399653428050469, 50.71677272657983], [-2.3998839555328706, 50.716957713987], [-2.4001144830152716, 50.71714270139417], [-2.400345010497673, 50.71732768880133], [-2.400575537980074, 50.7175126762085], [-2.4008060654624757, 50.71769766361566], [-2.4008060654624757, 50.717882651022826], [-2.4010365929448767, 50.71806763842999], [-2.4012671204272777, 50.71825262583716], [-2.4014976479096792, 50.718437613244326], [-2.4014976479096792, 50.718622600651486], [-2.4014976479096792, 50.71880758805865], [-2.4012671204272777, 50.71899257546582], [-2.4010365929448767, 50.719177562872986], [-2.4008060654624757, 50.71936255028015], [-2.400575537980074, 50.71954753768731], [-2.400575537980074, 50.71973252509448], [-2.400575537980074, 50.719917512501645], [-2.400575537980074, 50.72010249990881], [-2.400575537980074, 50.72028748731598], [-2.400345010497673, 50.720472474723145], [-2.4001144830152716, 50.720657462130305], [-2.3998839555328706, 50.720657462130305], [-2.399653428050469, 50.720657462130305], [-2.399422900568068, 50.720472474723145], [-2.399192373085667, 50.720472474723145], [-2.3989618456032655, 50.720657462130305], [-2.3987313181208645, 50.72084244953747], [-2.398500790638463, 50.72102743694464], [-2.398270263156062, 50.721212424351805], [-2.3980397356736605, 50.72139741175897], [-2.3978092081912594, 50.72139741175897], [-2.3975786807088584, 50.721212424351805], [-2.397348153226457, 50.72139741175897], [-2.397117625744056, 50.72158239916613], [-2.3968870982616544, 50.72158239916613], [-2.3966565707792533, 50.72158239916613], [-2.396426043296852, 50.72139741175897], [-2.396195515814451, 50.721212424351805], [-2.3959649883320497, 50.72139741175897], [-2.3957344608496483, 50.72158239916613], [-2.395503933367247, 50.7217673865733], [-2.3952734058848457, 50.721952373980464], [-2.3950428784024447, 50.721952373980464], [-2.394812350920043, 50.721952373980464], [-2.394581823437642, 50.721952373980464], [-2.394351295955241, 50.721952373980464], [-2.3941207684728396, 50.721952373980464], [-2.3938902409904386, 50.721952373980464], [-2.393659713508037, 50.721952373980464], [-2.393429186025636, 50.721952373980464], [-2.3931986585432345, 50.7217673865733], [-2.3929681310608335, 50.7217673865733], [-2.3927376035784325, 50.7217673865733], [-2.392507076096031, 50.7217673865733], [-2.39227654861363, 50.7217673865733], [-2.3920460211312284, 50.7217673865733], [-2.3918154936488274, 50.72158239916613], [-2.391584966166426, 50.72158239916613], [-2.391354438684025, 50.72139741175897], [-2.391123911201624, 50.72139741175897], [-2.3908933837192223, 50.72139741175897], [-2.3906628562368213, 50.72139741175897], [-2.39043232875442, 50.72139741175897], [-2.3902018012720188, 50.72158239916613], [-2.3899712737896177, 50.7217673865733], [-2.3897407463072162, 50.721952373980464], [-2.389510218824815, 50.72213736138763], [-2.3892796913424137, 50.7223223487948], [-2.3890491638600126, 50.722507336201964], [-2.388818636377611, 50.722692323609124], [-2.38858810889521, 50.72287731101629], [-2.388357581412809, 50.72306229842346], [-2.3881270539304076, 50.723247285830624], [-2.3878965264480065, 50.72343227323779], [-2.387665998965605, 50.72361726064495], [-2.387435471483204, 50.72380224805212], [-2.3872049440008025, 50.72398723545928], [-2.3872049440008025, 50.72417222286645], [-2.3872049440008025, 50.72435721027362], [-2.3872049440008025, 50.724542197680776], [-2.3869744165184015, 50.72472718508794], [-2.3867438890360004, 50.72491217249511], [-2.386513361553599, 50.725097159902276], [-2.386282834071198, 50.72528214730944], [-2.3860523065887964, 50.72546713471661], [-2.3858217791063954, 50.72565212212377], [-2.385591251623994, 50.725837109530936]];
        var pointLine2 = [];
        for(let i = 0; i<testLine2.length; i++) {
            cord = testLine2[i];
            coord = new L.latLng(cord[1], cord[0]);
            pointLine2.push(coord);
            
        };
        
        var line = new L.Polyline(pointLine2, {
            color: "yellow",
            weight: 3,
        });
        line.addTo(map);
        */

        </script>
</div>
{% endblock %}